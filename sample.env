# --- Postgres (required for m8flow-db; set POSTGRES_PASSWORD). ---
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres

# --- Flask / Backend ---
FLASK_DEBUG=1
FLASK_ENV=development
FLASK_APP=app.py
# Use a random secret (32+ chars).
FLASK_SESSION_SECRET_KEY=123456789abcdef0123456789abcdef

M8FLOW_BACKEND_ENV=local_development
M8FLOW_BACKEND_LOG_LEVEL=INFO
WATCHFILES_FORCE_POLLING=true

# --- Database (SQLAlchemy URI) ---
M8FLOW_BACKEND_DATABASE_TYPE=postgres
M8FLOW_BACKEND_DATABASE_URI=postgresql://postgres:postgres@<LOCAL_IP>:1111/postgres
# M8FLOW and Spiff DB migrations on startup.
M8FLOW_BACKEND_UPGRADE_DB=true
M8FLOW_BACKEND_SW_UPGRADE_DB=true


# --- Ports / URLs (replace <LOCAL_IP> with your machine IP or use localhost) ---
M8FLOW_BACKEND_PORT=8000
M8FLOW_BACKEND_URL=http://<LOCAL_IP>:8000
M8FLOW_BACKEND_URL_FOR_FRONTEND=http://<LOCAL_IP>:8001
SPIFFWORKFLOW_BACKEND_API_PATH_PREFIX=/v1.0
# CORS: comma-separated frontend origins (host:port).
M8FLOW_BACKEND_CORS_ALLOW_ORIGINS=localhost:8001,localhost:7001,localhost:5173,127.0.0.1:8001
SPIFFWORKFLOW_BACKEND_CORS_ALLOW_ORIGINS=localhost:8001,localhost:7001,localhost:5173,127.0.0.1:8001

# BPMN and templates paths (container or host).
M8FLOW_BACKEND_BPMN_SPEC_ABSOLUTE_DIR=./process_models
M8FLOW_TEMPLATES_STORAGE_DIR=./templates

# --- Auth (OIDC / Keycloak) ---
M8FLOW_KEYCLOAK_URL=http://<LOCAL_IP>:7002
M8FLOW_BACKEND_OPEN_ID_SERVER_URL=http://<LOCAL_IP>:7002/realms/spiffworkflow
M8FLOW_BACKEND_OPEN_ID_CLIENT_ID=spiffworkflow-backend
M8FLOW_BACKEND_OPEN_ID_CLIENT_SECRET_KEY=
M8FLOW_BACKEND_OPEN_ID_IS_AUTHORITY_FOR_USER_GROUPS=true
KEYCLOAK_ENABLE_CLIENT_AUTH=false
# Tenant JWT / tenant login: PKCS#12 keystore (optional).
M8FLOW_KEYCLOAK_SPOKE_CLIENT_ID=spiffworkflow-backend
M8FLOW_KEYCLOAK_SPOKE_KEYSTORE_P12=extensions/m8flow-backend/keystore.p12
# Keystore password; required for tenant login flow when using spoke keystore.
M8FLOW_KEYCLOAK_SPOKE_KEYSTORE_PASSWORD=

# Optional: SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS for Keycloak (identifier should match frontend cookie).
# For create-realm/create-tenant with master-realm token, add a second config: identifier=master, uri=.../realms/master, client_id=admin-cli.
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__0__identifier=spiffworkflow-local
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__0__label=Keycloak
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__0__uri=http://localhost:7002/realms/spiffworkflow-local
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__0__client_id=spiffworkflow-backend
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__0__client_secret=JXeQExm0JhQPLumgHtIIqf52bDalHz0q
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__1__identifier=master
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__1__uri=http://localhost:7002/realms/master
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__1__client_id=admin-cli
# SPIFFWORKFLOW_BACKEND_AUTH_CONFIGS__1__client_secret=

# --- Celery / Redis ---
M8FLOW_BACKEND_CELERY_ENABLED=false
M8FLOW_BACKEND_CELERY_BROKER_URL=redis://<LOCAL_IP>:6379/0
M8FLOW_BACKEND_CELERY_RESULT_BACKEND=redis://<LOCAL_IP>:6379/0
M8FLOW_BACKEND_RUNNING_IN_CELERY_WORKER=false
M8FLOW_BACKEND_RUN_BACKGROUND_SCHEDULER_IN_CREATE_APP=true

# --- Frontend (backend base URL; URL_FOR_FRONTEND is what frontend uses to reach API) ---
M8FLOW_BACKEND_URL_FRONTEND=http://<LOCAL_IP>:8000
M8FLOW_BACKEND_URL=http://<LOCAL_IP>:8000

# --- Connector proxy ---
CONNECTOR_PROXY_PORT=8004
M8FLOW_BACKEND_CONNECTOR_PROXY_URL=http://<LOCAL_IP>:8004
# --- M8Flow Connector: SMTP ---
# Local directory for connector to map attachments to.
M8FLOW_CONNECTOR_SMTP_ATTACHMENTS_DIR=../email_attachments
# Mapped volume name for attachments directory. Users will select files from this directory when attaching files in the service task. E.g.: "/email_attachments/file.pdf".
M8FLOW_CONNECTOR_SMTP_ATTACHMENTS_USER_ACCESS_DIR=/email_attachments
M8FLOW_CONNECTOR_SMTP_ATTACHMENTS_LIMIT_IN_MB=10
M8FLOW_CONNECTOR_SMTP_TIMEOUT_SECONDS=300


# --- Permissions ---
M8FLOW_BACKEND_PERMISSIONS_FILE_ABSOLUTE_PATH=./extensions/m8flow-backend/src/m8flow_backend/config/permissions/m8flow.yml
#M8FLOW_BACKEND_PERMISSIONS_FILE_NAME=m8flow.yml

# Multitenant: true = tenant selection at / and /tenants/check; false = single-tenant.
MULTI_TENANT_ON=false

# --- SQLAlchemy Logs ---
M8FLOW_SQLALCHEMY_ECHO=false

# --- Encryption (sensitive data at rest) ---
M8FLOW_BACKEND_ENCRYPTION_LIB=cryptography
M8FLOW_BACKEND_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef

# --- Tenancy ---
# Default tenant id; one Keycloak realm per tenant.
M8FLOW_DEFAULT_TENANT_ID=default
M8FLOW_ALLOW_MISSING_TENANT_CONTEXT=true
# JWT claim name for tenant id. Default: m8flow_tenant_id
# M8FLOW_TENANT_CLAIM=m8flow_tenant_id

# --- Keycloak ---
KEYCLOAK_ADMIN=admin
# Keycloak admin URL and realm.
KEYCLOAK_URL=http://<LOCAL_IP>:7002
KEYCLOAK_REALM=tenant-a
KEYCLOAK_ADMIN_USER=admin
# Admin password for create-realm API (KEYCLOAK_ADMIN_PASSWORD or M8FLOW_KEYCLOAK_ADMIN_PASSWORD).
KEYCLOAK_ADMIN_PASSWORD=admin
KEYCLOAK_CLIENT_ID=my-backend-app
KEYCLOAK_CLIENT_SECRET=
# Optional mTLS: KEYCLOAK_CERT_FILE, KEYCLOAK_KEY_FILE.
# KEYCLOAK_CERT_FILE=
# KEYCLOAK_KEY_FILE=
KC_DB_URL=jdbc:postgresql://keycloak-db:5432/keycloak
KC_DB_USERNAME=keycloak
KC_DB_PASSWORD=keycloak
KC_HTTP_PORT=8080
KC_HOSTNAME_STRICT=false


# --- MinIO ---
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin